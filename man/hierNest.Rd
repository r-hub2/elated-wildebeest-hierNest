% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hierNest.R
\name{hierNest}
\alias{hierNest}
\title{Fit Hierarchical Nested Regularization Model (hierNest)}
\usage{
hierNest(
  x,
  y,
  group = NULL,
  family = c("gaussian", "binomial"),
  nlambda = 100,
  lambda.factor = NULL,
  lambda = NULL,
  pf_group = NULL,
  pf_sparse = NULL,
  intercept = FALSE,
  asparse1 = 1,
  asparse2 = 0.05,
  standardize = TRUE,
  lower_bnd = -Inf,
  upper_bnd = Inf,
  eps = 1e-08,
  maxit = 3e+06,
  hier_info = NULL,
  random_asparse = FALSE,
  method = "overlapping"
)
}
\arguments{
\item{x}{Matrix of predictors (\eqn{n \times p}), where each row is an observation.}

\item{y}{Response variable (numeric for "gaussian", binary or factor for "binomial").}

\item{group}{Optional grouping vector (not required for "overlapping" method).}

\item{family}{Model family; either "gaussian" for least squares or "binomial" for logistic regression.}

\item{nlambda}{Number of lambda values in the regularization path (default: 100).}

\item{lambda.factor}{Factor for minimal value of lambda in the sequence.}

\item{lambda}{Optional user-supplied lambda sequence.}

\item{pf_group}{Penalty factor(s) for each group; defaults to sqrt(group size).}

\item{pf_sparse}{Penalty factors for individual predictors (L1 penalty).}

\item{intercept}{Logical; should an intercept be included? Default is FALSE.}

\item{asparse1}{Relative weight for group-level penalty (default: 1).}

\item{asparse2}{Relative weight for subgroup-level penalty (default: 0.05).}

\item{standardize}{Logical; standardize predictors? Default is TRUE.}

\item{lower_bnd}{Lower bound for coefficients (default: -Inf).}

\item{upper_bnd}{Upper bound for coefficients (default: Inf).}

\item{eps}{Convergence tolerance (default: 1e-8).}

\item{maxit}{Maximum number of optimization iterations (default: 3e6).}

\item{hier_info}{Required. Matrix encoding the hierarchical structure (see Details).}

\item{random_asparse}{Logical; use random sparse penalty? Default: FALSE.}

\item{method}{Type of hierarchical regularization ("overlapping" [default], "sparsegl", or "general").}
}
\value{
Returns a model fit object as produced by \code{hierNest::overlapping_gl}, including selected coefficients,
cross-validation results, and tuning parameters.
}
\description{
Fits a hierarchical nested penalized regression model for subgroup-specific effects using
overlapping group lasso penalties. This function encodes the hierarchical structure (e.g., MDC and DRG)
via a reparameterized design matrix and enables information borrowing across related subgroups.
}
\details{
This function builds a hierarchical design matrix reflecting group/subgroup structure (e.g., Major Diagnostic Categories [MDCs]
and Diagnosis Related Groups [DRGs]), encoding overall, group-specific, and subgroup-specific effects. It fits a penalized model
using overlapping group lasso, as described in Jiang et al. (2024, submitted). The main computational engine is \code{hierNest::overlapping_gl}.
}
\examples{
# Example with toy data
set.seed(123)
n <- 60; p <- 4
x <- matrix(rnorm(n * p), n, p)
y <- rbinom(n, 1, plogis(x[,1] - 0.5*x[,2]))
# Create toy hier_info: 2 groups, 3 subgroups in each
hier_info <- cbind(rep(1:2, each=n/2), rep(1:4, each = n/4))
library(rTensor)
fit1=hierNest::hierNest(x,y,method="overlapping",  ## Overlapping group lasso method
                      hier_info=hier_info,  ## Should input the hierarchical information for the groups
                      random_asparse = FALSE,  ## Randomly draw the other two tuning parameter?
                      nlambda=100, asparse1 = rep(1,100), 
                      asparse2 = rep(1,100), intercept = FALSE,  ## Set intercept = FALSE can potentially save a huge amount of time
                      family="binomial")

}
\references{
Jiang, Z., Huo, L., Hou, J., Vaughan-Sarrazin, M., Smith, M. A., & Huling, J. D. (2024).
Heterogeneous readmission prediction with hierarchical effect decomposition and regularization.
}
\seealso{
[hierNest::overlapping_gl()]
}
